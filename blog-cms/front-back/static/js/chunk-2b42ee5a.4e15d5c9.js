(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2b42ee5a"],{"0f5d":function(t,e,n){},1276:function(t,e,n){"use strict";var i=n("d784"),a=n("44e7"),o=n("825a"),s=n("1d80"),c=n("4840"),r=n("8aa5"),l=n("50c4"),u=n("14c3"),h=n("9263"),p=n("d039"),f=[].push,d=Math.min,m=4294967295,g=!p((function(){return!RegExp(m,"y")}));i("split",2,(function(t,e,n){var i;return i="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,n){var i=String(s(this)),o=void 0===n?m:n>>>0;if(0===o)return[];if(void 0===t)return[i];if(!a(t))return e.call(i,t,o);var c,r,l,u=[],p=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),d=0,g=new RegExp(t.source,p+"g");while(c=h.call(g,i)){if(r=g.lastIndex,r>d&&(u.push(i.slice(d,c.index)),c.length>1&&c.index<i.length&&f.apply(u,c.slice(1)),l=c[0].length,d=r,u.length>=o))break;g.lastIndex===c.index&&g.lastIndex++}return d===i.length?!l&&g.test("")||u.push(""):u.push(i.slice(d)),u.length>o?u.slice(0,o):u}:"0".split(void 0,0).length?function(t,n){return void 0===t&&0===n?[]:e.call(this,t,n)}:e,[function(e,n){var a=s(this),o=void 0==e?void 0:e[t];return void 0!==o?o.call(e,a,n):i.call(String(a),e,n)},function(t,a){var s=n(i,t,this,a,i!==e);if(s.done)return s.value;var h=o(t),p=String(this),f=c(h,RegExp),v=h.unicode,b=(h.ignoreCase?"i":"")+(h.multiline?"m":"")+(h.unicode?"u":"")+(g?"y":"g"),w=new f(g?h:"^(?:"+h.source+")",b),y=void 0===a?m:a>>>0;if(0===y)return[];if(0===p.length)return null===u(w,p)?[p]:[];var S=0,x=0,R=[];while(x<p.length){w.lastIndex=g?x:0;var k,C=u(w,g?p:p.slice(x));if(null===C||(k=d(l(w.lastIndex+(g?0:x)),p.length))===S)x=r(p,x,v);else{if(R.push(p.slice(S,x)),R.length===y)return R;for(var P=1;P<=C.length-1;P++)if(R.push(C[P]),R.length===y)return R;x=S=k}}return R.push(p.slice(S)),R}]}),!g)},1616:function(t,e,n){"use strict";n("77b6")},"77b6":function(t,e,n){},b6a0:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-row",[n("el-select",{staticStyle:{"min-width":"300px"},attrs:{placeholder:"请选择仓库",filterable:!0},on:{change:t.changeRepos},model:{value:t.activeRepos,callback:function(e){t.activeRepos=e},expression:"activeRepos"}},t._l(t.reposList,(function(t){return n("el-option",{key:t.id,attrs:{label:t.name,value:t.name}})})),1),n("el-cascader",{key:t.resourceShow,staticStyle:{"min-width":"450px"},attrs:{placeholder:"请选择目录",options:t.pathArr,props:t.pathProps,disabled:!t.activeRepos},model:{value:t.activePath,callback:function(e){t.activePath=e},expression:"activePath"}}),n("el-button",{attrs:{type:"primary",size:"medium",icon:"el-icon-search",disabled:!t.activeRepos},on:{click:t.search}},[t._v("查询")]),n("el-switch",{attrs:{"active-text":"CDN","inactive-text":"源站",disabled:!t.activeRepos},model:{value:t.isCDN,callback:function(e){t.isCDN=e},expression:"isCDN"}}),n("el-button",{staticClass:"right-item",attrs:{type:"primary",size:"medium",icon:"el-icon-upload",disabled:!t.activeRepos},on:{click:function(e){t.isDrawerShow=!t.isDrawerShow}}},[t._v("上传")])],1),t.hintShow1?n("el-alert",{attrs:{title:"只显示<img>标签支持的 apng,avif,bmp,gif,ico,cur,jpg,jpeg,jfif,pjpeg,pjp,png,svg,tif,tiff,webp 格式的图片，见 https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/img",type:"warning","show-icon":"","close-text":"不再提示"},on:{close:function(e){return t.noDisplay(1)}}}):t._e(),t.hintShow2?n("el-alert",{attrs:{title:"仅支持获取1000个文件内的目录，超出则将请求失败",type:"warning","show-icon":"","close-text":"不再提示"},on:{close:function(e){return t.noDisplay(2)}}}):t._e(),t.hintShow3?n("el-alert",{attrs:{title:"不可上传同名文件，否则将收到422错误码，如需替换，请先删除原文件",type:"warning","show-icon":"","close-text":"不再提示"},on:{close:function(e){return t.noDisplay(3)}}}):t._e(),n("el-row",{directives:[{name:"viewer",rawName:"v-viewer"}]},t._l(t.fileList,(function(e,i){return n("div",{key:i,staticClass:"image-container"},[n("el-image",{attrs:{src:t.imgUrl(e),fit:"scale-down"}}),n("div",{staticClass:"image-content"},[n("div",{staticClass:"info"},[n("span",[t._v(t._s(e.name))])]),n("div",{staticClass:"icons"},[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"复制CDN链接",placement:"bottom"}},[n("i",{staticClass:"icon el-icon-link",on:{click:function(n){return t.copy(1,e)}}})]),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"复制MD格式",placement:"bottom"}},[n("SvgIcon",{attrs:{"icon-class":"markdown","class-name":"icon"},on:{click:function(n){return t.copy(2,e)}}})],1),n("i",{staticClass:"icon el-icon-delete",on:{click:function(n){return t.delFile(e)}}})],1)])],1)})),0),n("el-drawer",{attrs:{title:"上传文件",visible:t.isDrawerShow,direction:"rtl",size:"40%",wrapperClosable:!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.isDrawerShow=e}}},[n("el-row",[n("el-radio",{attrs:{label:"1"},model:{value:t.nameType,callback:function(e){t.nameType=e},expression:"nameType"}},[t._v("使用源文件名")]),n("el-radio",{attrs:{label:"2"},model:{value:t.nameType,callback:function(e){t.nameType=e},expression:"nameType"}},[t._v("使用UUID文件名")]),n("el-button",{directives:[{name:"throttle",rawName:"v-throttle",value:[t.submitUpload,"click",3e3],expression:"[submitUpload,`click`,3000]"}],attrs:{size:"small",type:"primary",icon:"el-icon-upload"}},[t._v("确定上传")])],1),n("el-row",[t._v(" 当前目录："+t._s(t.realPath)+" ")]),n("el-row",[n("el-switch",{attrs:{"active-text":"自定义目录"},model:{value:t.isCustomPath,callback:function(e){t.isCustomPath=e},expression:"isCustomPath"}}),n("el-input",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"例：oldFolder/newFolder/",disabled:!t.isCustomPath,size:"medium"},model:{value:t.customPath,callback:function(e){t.customPath=e},expression:"customPath"}})],1),n("el-upload",{ref:"uploadRef",attrs:{action:"","http-request":t.upload,drag:"",multiple:"","file-list":t.uploadList,"list-type":"picture","auto-upload":!1}},[n("i",{staticClass:"el-icon-upload"}),n("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),n("em",[t._v("点击上传")])])])],1)],1)},a=[],o=n("1da1"),s=(n("96cf"),n("a15b"),n("99af"),n("d3b7"),n("159b"),n("b0c0"),n("ac1f"),n("841c"),n("1276"),n("c00a")),c=n("c9f7"),r=n("c54a"),l=n("f988"),u=n("f43e"),h=[],p=null;function f(){if(0===h.length)return clearInterval(p),void(p=null);var t=h.shift();t(),0===h.length&&(clearInterval(p),p=null)}function d(t,e){h.push(t),p||(f(),p=setInterval(f,e))}var m={name:"GithubManage",components:{SvgIcon:s["a"]},data:function(){var t=this;return{reposList:[],pathArr:[{value:"",label:"根目录"}],activeRepos:"",activePath:[""],pathProps:{lazy:!0,checkStrictly:!0,lazyLoad:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(n,i){var a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=n.path.join("/"),o=[],e.next=4,t.getReposContents(o,a);case 4:i(o);case 5:case"end":return e.stop()}}),e)})));function n(t,n){return e.apply(this,arguments)}return n}()},hintShow1:!0,hintShow2:!0,hintShow3:!0,fileList:[],resourceShow:0,isDrawerShow:!1,nameType:"1",uploadList:[],isCDN:!0,isCustomPath:!1,customPath:""}},computed:{realPath:function(){return this.isCustomPath?"/".concat(this.userInfo.login,"/").concat(this.activeRepos,"/").concat(this.customPath):"/".concat(this.userInfo.login,"/").concat(this.activeRepos).concat(this.activePath.join("/"),"/")}},created:function(){this.hintShow1=!localStorage.getItem("hintShow1"),this.hintShow2=!localStorage.getItem("hintShow2"),this.hintShow3=!localStorage.getItem("hintShow3");var t=localStorage.getItem("githubToken"),e=localStorage.getItem("githubUserInfo");t&&e?(this.userInfo=JSON.parse(e),this.getRepos()):(this.msgError("请先配置Token"),this.$router.push("/pictureHosting/setting"))},methods:{getRepos:function(){var t=this;Object(c["d"])(this.userInfo.login).then((function(e){t.reposList=e}))},changeRepos:function(){this.resourceShow++,this.activePath=[""],this.fileList=[]},getReposContents:function(t,e){var n=this;return Object(o["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,Object(c["b"])(n.userInfo.login,n.activeRepos,e).then((function(e){e.forEach((function(e){"dir"===e.type&&t.push({value:e.name,label:e.name,leaf:!1})}))}));case 2:case"end":return i.stop()}}),i)})))()},search:function(){var t=this;this.fileList=[];var e=this.activePath.join("/");Object(c["b"])(this.userInfo.login,this.activeRepos,e).then((function(e){e.forEach((function(e){"file"===e.type&&Object(r["b"])(e.name)&&t.fileList.push(e)}))}))},noDisplay:function(t){localStorage.setItem("hintShow".concat(t),"1")},imgUrl:function(t){return this.isCDN?"https://fastly.jsdelivr.net/gh/".concat(this.userInfo.login,"/").concat(this.activeRepos,"/").concat(t.path):t.download_url},copy:function(t,e){var n="https://fastly.jsdelivr.net/gh/".concat(this.userInfo.login,"/").concat(this.activeRepos,"/").concat(e.path),i=n;2==t&&(i="![".concat(e.name,"](").concat(n,")")),Object(u["a"])(i),this.msgSuccess("复制成功")},delFile:function(t){var e=this;this.$confirm("此操作将永久删除该文件, 是否删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var n={message:"Delete file via PictureHosting",sha:t.sha};Object(c["a"])(e.userInfo.login,e.activeRepos,t.path,n).then((function(){e.msgSuccess("删除成功"),e.search()}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},submitUpload:function(){this.uploadList=this.$refs.uploadRef.uploadFiles,this.uploadList.length?this.$refs.uploadRef.submit():this.msgError("请先选择文件")},upload:function(t){var e=this,n=new FileReader;n.readAsDataURL(t.file),n.onload=function(){var i=n.result.split(",")[1],a=t.file.name;"2"===e.nameType&&(a=Object(l["a"])()+a.substr(a.lastIndexOf("."))),d((function(){return e.push2Github(t,a,i)}),1e3)}},push2Github:function(t,e,n){var i=this,a={message:"Add files via PictureHosting",content:n},o=this.activePath.join("/");this.isCustomPath&&("/"===this.customPath?o="":(o=this.customPath,"/"!==o.charAt(0)&&(o="/"+o),"/"===o.charAt(o.length-1)&&(o=o.substring(0,o.length-1)))),Object(c["e"])(this.userInfo.login,this.activeRepos,o,e,a).then((function(){i.msgSuccess("上传成功"),t.onSuccess()}))}}},g=m,v=(n("e9fc"),n("1616"),n("2877")),b=Object(v["a"])(g,i,a,!1,null,"23d96e02",null);e["default"]=b.exports},c9f7:function(t,e,n){"use strict";n.d(e,"c",(function(){return l})),n.d(e,"d",(function(){return u})),n.d(e,"b",(function(){return h})),n.d(e,"a",(function(){return p})),n.d(e,"e",(function(){return f}));n("ac1f"),n("00b4"),n("d3b7"),n("99af");var i=n("bc3a"),a=n.n(i),o=n("323e"),s=n.n(o),c=(n("a5d8"),n("5c96")),r=a.a.create({baseURL:"https://api.github.com",timeout:3e4});function l(t){return r({url:"/user",method:"GET",headers:{Authorization:"token ".concat(t)}})}function u(t){return r({url:"/users/".concat(t,"/repos"),method:"GET"})}function h(t,e,n){return r({url:"/repos/".concat(t,"/").concat(e,"/contents").concat(n),method:"GET"})}function p(t,e,n,i){return r({url:"/repos/".concat(t,"/").concat(e,"/contents/").concat(n),method:"DELETE",data:i})}function f(t,e,n,i,a){return r({url:"/repos/".concat(t,"/").concat(e,"/contents").concat(n,"/").concat(i),method:"PUT",data:a})}r.interceptors.request.use((function(t){s.a.start(),/get/i.test(t.method)&&(t.params=t.params||{},t.params.t=(new Date).getTime());var e=localStorage.getItem("githubToken");return e&&(t.headers.Authorization="token ".concat(e)),t}),(function(t){return console.info(t),Promise.reject(t)})),r.interceptors.response.use((function(t){return s.a.done(),t.data}),(function(t){return console.info(t),c["Message"].error(t.message),Promise.reject(t)}))},e9fc:function(t,e,n){"use strict";n("0f5d")}}]);